{"version":3,"sources":["event-list-plugin.js"],"names":["EB_WIDGETS_SRC","EBEventListFactory","url","callback","$","ajax","dataType","success","async","divTargetId","organizerId","eventImageWidth","pageNumber","pageSize","buttonText","apiToken","onOrderComplete","eventImageHeight","data","numberElems","pagination","page_size","page_number","pageCount","page_count","i","push","click","setPageNumber","bind","pageNumbers","append","dateStr","date","Date","toLocaleDateString","event","eventDescription","summary","id","name","image","_formatDateString","start_date","start_time","end_time","renderEvents","html","events","length","markup","_getEventMarkup","apply","window","EBWidgets","createWidget","widgetType","eventId","modal","modalTriggerElementId","_getPageNumbers","requestUrl","get","scriptLoaded","_loadScript","_doRender"],"mappings":"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","file":"all.js","sourcesContent":["const EB_WIDGETS_SRC = 'https://www.eventbrite.com/static/widgets/eb_widgets.js';\n\nclass EBEventListFactory {\n\n    _loadScript(url, callback) {\n        $.ajax({\n            url: url,\n            dataType: 'script',\n            success: callback,\n            async: true\n        });\n    }\n\n    constructor({\n        divTargetId,\n        organizerId,\n        eventImageWidth = 300,\n        pageNumber = 1,\n        pageSize = 10,\n        buttonText = \"Get Tickets\",\n        apiToken,\n        onOrderComplete = () => {},\n    }) {\n        this.organizerId = organizerId;\n        this.eventImageHeight = eventImageWidth / 2;\n        this.eventImageWidth = eventImageWidth;\n        this.divTargetId = divTargetId;\n        this.pageSize = pageSize;\n        this.pageNumber = pageNumber;\n        this.apiToken = apiToken;\n        this.buttonText = buttonText;\n        this.onOrderComplete = onOrderComplete;\n    }\n\n    _getPageNumbers(data) {\n        const numberElems = [];\n        const { page_size: pageSize, page_number: pageNumber, page_count: pageCount } = data.pagination;\n\n        for (let i = 0; i < pageCount; i++) {\n            if (i + 1 === pageNumber) {\n                numberElems.push($(`<span class=\"page-number--active\">${i + 1}</span>`));\n            } else {\n                numberElems.push($(`<a class=\"page-number\" href=\"javascript:void(0)\">${i + 1}</a>`).click(this.setPageNumber.bind(this, i + 1)));\n            }\n        }\n        let pageNumbers = $(`<div class=\"page-numbers\"></div>`);\n        pageNumbers.append(numberElems);\n\n        return pageNumbers;\n    }\n\n    _formatDateString(dateStr) {\n        let date = new Date(dateStr);\n\n        return date.toLocaleDateString();\n    }\n\n    _getEventMarkup(event) {\n        const eventDescription = event.summary ?\n        `<div class=\"event description\">\n            ${event.summary}\n        </div` : '';\n        return $(\n            `<div class=\"event-detail\" id=\"${event.id}\">\n                <a class=\"background--inner has-image\"\n                    href=\"${event.url}\"\n                    title=\"${event.name}\"\n                    tabindex=\"-1\"\n                    style=\"background-image: url(${event.image ? event.image.url : ''});\n                    height: ${this.eventImageHeight}px;\n                    width: ${this.eventImageWidth}px;\n                    display: block;\"\n                />\n                <div class=\"details\">\n                    <div class=\"block\">\n                        <h1 class=\"title title--text\">\n                            <a title=\"${event.name}\" href=\"${event.url}\">${event.name}</a>\n                        </h1>\n                        <div class=\"date icon-date\">\n                            <span class=\"date__day\">\n                                ${this._formatDateString(event.start_date)}\n                            </span>\n                            <span class=\"date__time\">\n                                ${event.start_time} - ${event.end_time}\n                            </span>\n                        </div>\n                        ${eventDescription}\n                    </div>\n                    <div class=\"register-button\">\n                        <button id=\"register-button-${event.id}\" class=\"event-button\">\n                            ${this.buttonText}\n                        </button>\n                    </div>\n                </div>\n            </div>`\n        );\n    }\n\n    setPageNumber(pageNumber) {\n        this.pageNumber = pageNumber;\n        this.renderEvents();\n    }\n\n    _doRender(data) {\n        // Reset markup in target div\n        $('#' + this.divTargetId).html('');\n\n        for (let i = 0; i < data.events.length; i++) {\n            const event = data.events[i];\n            const markup = this._getEventMarkup.apply(this, [event]);\n            $('#' + this.divTargetId).append(markup);\n            window.EBWidgets.createWidget({\n                widgetType: 'checkout',\n                eventId: event.id,\n                modal: true,\n                modalTriggerElementId: `register-button-${event.id}`,\n                onOrderComplete: this.onOrderComplete\n            });\n        }\n\n        const pageNumbers = this._getPageNumbers(data);\n\n        $('#' + this.divTargetId)\n            .append(pageNumbers);\n    }\n\n    renderEvents() {\n        const requestUrl = `https://www.eventbriteapi.com/v3/destination/organizers/${this.organizerId}/events/?token=${this.apiToken}&expand=image&time_filter=current_future&page_size=${this.pageSize}&page_number=${this.pageNumber}`;\n\n        $.get(requestUrl,\n            (data) => {\n\n                if (!this.scriptLoaded) {\n                    this._loadScript(EB_WIDGETS_SRC,\n                        () => {\n                            this._doRender.apply(this, [data]);\n                            this.scriptLoaded = true;\n                        }\n                    );\n                } else {\n                    this._doRender.apply(this, [data]);\n                }\n            }\n        );\n\n    }\n\n}\n"]}